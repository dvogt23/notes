<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rails - Knowledge book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Fixable notes of my life and experience">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../styles/footer.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Summary</li><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Knowledge</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Tech</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.1.</strong> Apps</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tech/app/pass.html"><strong aria-hidden="true">2.1.1.</strong> Pass</a></li><li class="chapter-item expanded "><a href="../../tech/app/vim.html"><strong aria-hidden="true">2.1.2.</strong> Vim</a></li><li class="chapter-item expanded "><a href="../../tech/app/firefox.html"><strong aria-hidden="true">2.1.3.</strong> Firefox</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.2.</strong> Coding</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tech/coding/bash.html"><strong aria-hidden="true">2.2.1.</strong> Bash</a></li><li class="chapter-item expanded "><a href="../../tech/coding/basic.html"><strong aria-hidden="true">2.2.2.</strong> Basic</a></li><li class="chapter-item expanded "><a href="../../tech/coding/environment.html"><strong aria-hidden="true">2.2.3.</strong> Environment</a></li><li class="chapter-item expanded "><a href="../../tech/coding/general.html"><strong aria-hidden="true">2.2.4.</strong> General</a></li><li class="chapter-item expanded "><a href="../../tech/coding/git.html"><strong aria-hidden="true">2.2.5.</strong> Git</a></li><li class="chapter-item expanded "><a href="../../tech/coding/javascript.html"><strong aria-hidden="true">2.2.6.</strong> Javascript</a></li><li class="chapter-item expanded "><a href="../../tech/coding/kotlin.html"><strong aria-hidden="true">2.2.7.</strong> Kotlin</a></li><li class="chapter-item expanded "><a href="../../tech/coding/make.html"><strong aria-hidden="true">2.2.8.</strong> Make</a></li><li class="chapter-item expanded "><a href="../../tech/coding/maven.html"><strong aria-hidden="true">2.2.9.</strong> Maven</a></li><li class="chapter-item expanded "><a href="../../tech/coding/postgres.html"><strong aria-hidden="true">2.2.10.</strong> Postgres</a></li><li class="chapter-item expanded "><a href="../../tech/coding/projects.html"><strong aria-hidden="true">2.2.11.</strong> Projects</a></li><li class="chapter-item expanded "><a href="../../tech/coding/python.html"><strong aria-hidden="true">2.2.12.</strong> Python</a></li><li class="chapter-item expanded "><a href="../../tech/coding/rails.html" class="active"><strong aria-hidden="true">2.2.13.</strong> Rails</a></li><li class="chapter-item expanded "><a href="../../tech/coding/react.html"><strong aria-hidden="true">2.2.14.</strong> React</a></li><li class="chapter-item expanded "><a href="../../tech/coding/ruby.html"><strong aria-hidden="true">2.2.15.</strong> Ruby</a></li><li class="chapter-item expanded "><a href="../../tech/coding/rust.html"><strong aria-hidden="true">2.2.16.</strong> Rust</a></li><li class="chapter-item expanded "><a href="../../tech/coding/typescript.html"><strong aria-hidden="true">2.2.17.</strong> TypeScript</a></li></ol></li><li class="chapter-item expanded "><a href="../../tech/equipment.html"><strong aria-hidden="true">2.3.</strong> Equipment</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> Linux</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tech/linux/apps.html"><strong aria-hidden="true">2.4.1.</strong> Apps</a></li><li class="chapter-item expanded "><a href="../../tech/linux/arch.html"><strong aria-hidden="true">2.4.2.</strong> Arch linux</a></li><li class="chapter-item expanded "><a href="../../tech/linux/commands.html"><strong aria-hidden="true">2.4.3.</strong> Commands</a></li></ol></li><li class="chapter-item expanded "><a href="../../tech/scrum.html"><strong aria-hidden="true">2.5.</strong> Scrum</a></li><li class="chapter-item expanded "><a href="../../tech/selfhosting/index.html"><strong aria-hidden="true">2.6.</strong> Self-hosting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tech/selfhosting/ideas.html"><strong aria-hidden="true">2.6.1.</strong> Ideas</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.7.</strong> Smart-Home</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../tech/smarthome/knx.html"><strong aria-hidden="true">2.7.1.</strong> KNX</a></li><li class="chapter-item expanded "><a href="../../tech/smarthome/homeassistent.html"><strong aria-hidden="true">2.7.2.</strong> Home-Assistent</a></li></ol></li><li class="chapter-item expanded "><a href="../../tech/security.html"><strong aria-hidden="true">2.8.</strong> Security</a></li><li class="chapter-item expanded "><a href="../../tech/splitkb.html"><strong aria-hidden="true">2.9.</strong> Split-keyboard</a></li><li class="chapter-item expanded "><a href="../../tech/misc.html"><strong aria-hidden="true">2.10.</strong> Misc</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Personal</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.1.</strong> Input</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../personal/input/music.html"><strong aria-hidden="true">3.1.1.</strong> Music</a></li><li class="chapter-item expanded "><a href="../../personal/input/books.html"><strong aria-hidden="true">3.1.2.</strong> Books</a></li><li class="chapter-item expanded "><a href="../../personal/input/podcasts.html"><strong aria-hidden="true">3.1.3.</strong> Podcasts</a></li><li class="chapter-item expanded "><a href="../../personal/input/series.html"><strong aria-hidden="true">3.1.4.</strong> Series</a></li><li class="chapter-item expanded "><a href="../../personal/input/movies.html"><strong aria-hidden="true">3.1.5.</strong> Movies</a></li><li class="chapter-item expanded "><a href="../../personal/input/videos.html"><strong aria-hidden="true">3.1.6.</strong> Videos</a></li><li class="chapter-item expanded "><a href="../../personal/input/articles.html"><strong aria-hidden="true">3.1.7.</strong> Articles</a></li><li class="chapter-item expanded "><a href="../../personal/input/blogs.html"><strong aria-hidden="true">3.1.8.</strong> Blogs</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Home</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../personal/home/furniture.html"><strong aria-hidden="true">3.2.1.</strong> Furniture</a></li><li class="chapter-item expanded "><a href="../../personal/home/clothing.html"><strong aria-hidden="true">3.2.2.</strong> Clothing</a></li><li class="chapter-item expanded "><a href="../../personal/home/cooking.html"><strong aria-hidden="true">3.2.3.</strong> Cooking</a></li><li class="chapter-item expanded "><a href="../../personal/home/coffee.html"><strong aria-hidden="true">3.2.4.</strong> Coffee</a></li><li class="chapter-item expanded "><a href="../../personal/home/garden.html"><strong aria-hidden="true">3.2.5.</strong> Garden</a></li><li class="chapter-item expanded "><a href="../../personal/home/garage.html"><strong aria-hidden="true">3.2.6.</strong> Garage</a></li><li class="chapter-item expanded "><a href="../../personal/home/pharmacy.html"><strong aria-hidden="true">3.2.7.</strong> Pharmacy</a></li><li class="chapter-item expanded "><a href="../../personal/home/homestead.html"><strong aria-hidden="true">3.2.8.</strong> Homestead</a></li><li class="chapter-item expanded "><a href="../../personal/home/kids.html"><strong aria-hidden="true">3.2.9.</strong> Kids</a></li></ol></li><li class="chapter-item expanded "><a href="../../personal/learning/index.html"><strong aria-hidden="true">3.3.</strong> Learning</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Sport</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../personal/sport/cycling.html"><strong aria-hidden="true">3.4.1.</strong> Cycling</a></li><li class="chapter-item expanded "><a href="../../personal/sport/hiking.html"><strong aria-hidden="true">3.4.2.</strong> Hiking</a></li><li class="chapter-item expanded "><a href="../../personal/sport/basketball.html"><strong aria-hidden="true">3.4.3.</strong> Basketball</a></li></ol></li><li class="chapter-item expanded "><a href="../../personal/health.html"><strong aria-hidden="true">3.5.</strong> Health</a></li><li class="chapter-item expanded "><a href="../../personal/documents.html"><strong aria-hidden="true">3.6.</strong> Documents</a></li><li class="chapter-item expanded "><a href="../../personal/misc.html"><strong aria-hidden="true">3.7.</strong> Misc</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Travel</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">4.1.</strong> Countries</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../travel/austria.html"><strong aria-hidden="true">4.1.1.</strong> Austria</a></li><li class="chapter-item expanded "><a href="../../travel/columbia.html"><strong aria-hidden="true">4.1.2.</strong> Columbia</a></li><li class="chapter-item expanded "><a href="../../travel/france.html"><strong aria-hidden="true">4.1.3.</strong> France</a></li><li class="chapter-item expanded "><a href="../../travel/germany.html"><strong aria-hidden="true">4.1.4.</strong> Germany</a></li><li class="chapter-item expanded "><a href="../../travel/greatbritian.html"><strong aria-hidden="true">4.1.5.</strong> Great britian</a></li><li class="chapter-item expanded "><a href="../../travel/greek.html"><strong aria-hidden="true">4.1.6.</strong> Greek</a></li><li class="chapter-item expanded "><a href="../../travel/israel.html"><strong aria-hidden="true">4.1.7.</strong> Israel</a></li><li class="chapter-item expanded "><a href="../../travel/italy.html"><strong aria-hidden="true">4.1.8.</strong> Italy</a></li><li class="chapter-item expanded "><a href="../../travel/kroatia.html"><strong aria-hidden="true">4.1.9.</strong> Kroatia</a></li><li class="chapter-item expanded "><a href="../../travel/marokko.html"><strong aria-hidden="true">4.1.10.</strong> Marokko</a></li><li class="chapter-item expanded "><a href="../../travel/netherland.html"><strong aria-hidden="true">4.1.11.</strong> Netherland</a></li><li class="chapter-item expanded "><a href="../../travel/portugal.html"><strong aria-hidden="true">4.1.12.</strong> Portugal</a></li><li class="chapter-item expanded "><a href="../../travel/spain.html"><strong aria-hidden="true">4.1.13.</strong> Spain</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Misc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../misc/arts.html"><strong aria-hidden="true">5.1.</strong> Arts</a></li><li class="chapter-item expanded "><a href="../../misc/jokes.html"><strong aria-hidden="true">5.2.</strong> Jokes</a></li><li class="chapter-item expanded "><a href="../../misc/newwords.html"><strong aria-hidden="true">5.3.</strong> New words</a></li><li class="chapter-item expanded "><a href="../../misc/poems.html"><strong aria-hidden="true">5.4.</strong> Poems</a></li><li class="chapter-item expanded "><a href="../../misc/survival.html"><strong aria-hidden="true">5.5.</strong> Survival</a></li><li class="chapter-item expanded "><a href="../../misc/quotes.html"><strong aria-hidden="true">5.6.</strong> Quotes</a></li><li class="chapter-item expanded "><a href="../../misc/wie_man_gut_Schreibt.html"><strong aria-hidden="true">5.7.</strong> Wie man gut schreibt?</a></li><li class="chapter-item expanded "><a href="../../misc/29ways_to_stay_creative.html"><strong aria-hidden="true">5.8.</strong> 29 ways to stay creative</a></li><li class="chapter-item expanded "><a href="../../misc/simple_life.html"><strong aria-hidden="true">5.9.</strong> simple life</a></li><li class="chapter-item expanded "><a href="../../misc/productivity.html"><strong aria-hidden="true">5.10.</strong> Productivity</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Knowledge book</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/dvogt23/notes" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rails"><a class="header" href="#rails">Rails</a></h1>
<p>Rails is a very cool framework for web-applications and IMO the best for
mvp-prototyping and beyond.</p>
<h2 id="curriculum"><a class="header" href="#curriculum">Curriculum</a></h2>
<ul>
<li><a href="https://www.theodinproject.com/paths/full-stack-ruby-on-rails">Full Stack Ruby on Rails | theodinproject</a></li>
</ul>
<p>Learning from some youtube guys:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=8i5JFLfbWkE">Video</a> Source: <a href="https://github.com/justalever/projekt">Projekt</a></li>
<li><a href="https://www.youtube.com/watch?v=u2o_new-T0o&amp;t=555s">Video</a> Source:
<a href="https://github.com/StephenFiser/simple-pm/tree/episode-1">simple-pm</a></li>
<li>Best practises <a href="https://youtu.be/vw7PlBvLq9k">Semicolon&amp;Sons - Best practises I</a>
Passing ruby data to javaScript</li>
</ul>
<h2 id="articles"><a class="header" href="#articles">Articles</a></h2>
<ul>
<li>Great note collection from <a href="https://blog.corsego.com/">corsego</a>
<ul>
<li>devise, hotwire, turbo, darkmode, basics, views</li>
</ul>
</li>
<li>Some great articles about coding <a href="https://www.johnnunemaker.com/">johnnunemaker</a>
<ul>
<li>rails, ruby, …</li>
</ul>
</li>
<li>Great summary about encryption in rails7 <a href="https://blog.corsego.com/encrypted-credentials">corsego</a></li>
<li><a href="https://www.speedshop.co/2019/01/10/three-activerecord-mistakes.html#where-means-filtering-is-done-by-the-database">ActiveRecord Mistakes that slow down your app</a></li>
<li>Modularisation (Monolith):
<ul>
<li><a href="https://shopify.engineering/deconstructing-monolith-designing-software-maximizes-developer-productivity">Deconstructing the Monolith</a></li>
<li><a href="https://medium.com/@dan_manges/the-modular-monolith-rails-architecture-fb1023826fc4">The Modular Monolith: Rails Architecture | by Dan Manges | Medium</a></li>
<li><a href="https://blog.eq8.eu/article/rails-bounded-contexts.html">Ruby on Rails - Bounded contexts via interface objects</a></li>
<li><a href="https://medium.com/airtribe/enforcing-modularity-inside-a-rails-monolith-f856adb54e1d">Enforcing Modularity inside a Rails Monolith | by Thomas Pagram | The Airtasker Tribe | Medium</a></li>
<li><a href="https://shopify.engineering/enforcing-modularity-rails-apps-packwerk">Enforcing Modularity in Rails Apps with Packwerk</a></li>
</ul>
</li>
</ul>
<h3 id="pattern-matching"><a class="header" href="#pattern-matching">Pattern matching</a></h3>
<pre><code class="language-ruby">def extract(**data)
  case data
    in name: {first:}
      puts first
    in tags: [first_tag, *_]
      puts first_tag
  end
end

&gt; extract(name: { first: "Brad", last: "Gessler" })
"Brad"
&gt; extract(tags: ["person", "earthling"] })
"person"
</code></pre>
<pre><code class="language-ruby">def matcher(**data)
  if first = data.fetch(:first)
    puts first
  elsif data.key?(:tags)
    tags = data.fetch(:tags)
    if tags.is_a? Array
      puts tags.first
    end
  end
end
</code></pre>
<p>Source: <a href="https://fly.io/ruby-dispatch/pattern-matching-on-ruby-objects/">fly.io</a></p>
<h3 id="test-coverage-pre-commit-hook"><a class="header" href="#test-coverage-pre-commit-hook">Test coverage pre-commit hook</a></h3>
<p>To get an positive exit code for pre-commit hook integration you have to add this to your spec config:</p>
<pre><code class="language-ruby"># spec/spec_helper.rb
RSpec.configure do |config|
  if ENV["TEST_COVERAGE"]
    SimpleCov.start "rails" do
      spec_paths = ARGV.grep %r{(spec)/\w+}
      if spec_paths.any?
        file_paths = spec_paths.map { |spec_path| spec_path.gsub(%r{spec/|_spec}, "") }
        add_filter do |file|
          file_paths.none? do |file_path|
            if file.filename.include? "/app/"
              file.filename.match?(%r{/app/#{file_path}})
            else
              file.filename.include?(file_path)
            end
          end
        end
      end
      minimum_coverage 98.9
      minimum_coverage_by_file 81.4
    end
  else
    SimpleCov.start "rails"
  end
  [...]
</code></pre>
<p>Pre-commit hook:</p>
<pre><code class="language-bash">files=$(git --no-pager diff --name-only --cached --diff-filter=AM)
erbfiles=$(echo "$files" | grep -e '\.html.erb$')


[[ -n "$specfiles" ]] &amp;&amp; (TEST_COVERAGE=true bundle exec rspec "$specfiles" || exit 1)
</code></pre>
<h3 id="rails-erd"><a class="header" href="#rails-erd">Rails ERD</a></h3>
<p>For creating an erd diagram of your db schema, you could create a pdf with: <a href="https://github.com/voormedia/rails-erd">rails-erd</a> with this command:</p>
<p><code>bundle exec rails erd attributes=foreign_keys,primary_keys,timestamps,content notation=bachman</code></p>
<h3 id="race-conditions"><a class="header" href="#race-conditions">Race conditions</a></h3>
<p>Avoid race conditions with <code>ActiveRecord::Base.transaction do</code> and <code>Model.lock.find(model_id)</code> or <code>my_model_object.lock!</code></p>
<p>Source: <a href="https://www.fastruby.io/blog/rails/code-quality/An-introduction-to-race-condition.html">fastruby.io</a></p>
<h2 id="rspec"><a class="header" href="#rspec">RSpec</a></h2>
<h3 id="bisect-flaky-tests"><a class="header" href="#bisect-flaky-tests">Bisect flaky tests</a></h3>
<p>with <code>rspec --bisect &lt;file&gt;</code> you could find flaky test setting to re-run it.</p>
<h3 id="testing-an-array-with-attributes"><a class="header" href="#testing-an-array-with-attributes">Testing an array with attributes</a></h3>
<pre><code class="language-ruby">expect(items[0].id).to eql(1)
expect(items[0].name).to eql('One')
expect(items[1].id).to eql(2)
expect(items[1].name).to eql('Two')

expect(items[0]).to have_attributes(id: 1, name: 'One')
expect(items[1]).to have_attributes(id: 2, name: 'Two')

expect(items).to match_array([
  have_attributes(id: 1, name: 'One'),
  have_attributes(id: 2, name: 'Two'),
])
</code></pre>
<p>Source: <a href="https://www.benpickles.com/articles/73-testing-an-array-of-objects-with-rspec-have_attributes">benpickles</a></p>
<h3 id="custom-matcher"><a class="header" href="#custom-matcher">Custom matcher</a></h3>
<pre><code class="language-ruby">RSpec::Matchers.define :have_errors_on do |attribute|
  chain :with_message do |message|
    @message = message
  end

  match do |model|
    model.valid?

    @has_errors = model.errors.key?(attribute)

    if @message
      @has_errors &amp;&amp; model.errors[attribute].include?(@message)
    else
      @has_errors
    end
  end

 failure_message_for_should do |model|
     if @message
       "Validation errors #{model.errors[attribute].inspect} should include #{@message.inspect}"
     else
       "#{model.class} should have errors on attribute #{attribute.inspect}"
     end
   end

   failure_message_for_should_not do |model|
     "#{model.class} should not have an error on attribute #{attribute.inspect}"
   end
 end


# usage
describe User do
  before { subject.email = "foobar" }

  it { should have_errors_on(:email).with_message("Email has an invalid format") }

end
</code></pre>
<h2 id="data-class"><a class="header" href="#data-class">Data class</a></h2>
<p>Similiar to the <a href="https://docs.ruby-lang.org/en/master/Data.html">value-alike objects</a> in ruby(3.2), here an example for rails:</p>
<pre><code class="language-ruby">class DataClass
  ATTRIBUTES = %i[first_name last_name city zipcode phone_number].freeze

  include ActiveModel::Model

  attr_accessor *ATTRIBUTES

  def ==(object)
    ATTRIBUTES.all? { |attribute| public_send(attribute) == object.public_send(attribute) }
  end
end

ConsumerClass.new(DataClass({first_name: "Bill", last_name: "...", ...}))
</code></pre>
<p>Links: <a href="https://github.com/saturnflyer/polyfill-data">Polyfill - Data gem</a></p>
<h2 id="rspec-factory-trait--transient"><a class="header" href="#rspec-factory-trait--transient">RSpec factory trait &amp; transient</a></h2>
<pre><code class="language-ruby">FactoryBot.define do
  factory :user, class: User do
    trait :with_book do
      transient do
        # 🦄1. default value when you use :with_book trait
        # 🦄2. Dont't assign just 'Agile'. see also: https://thoughtbot.com/blog/deprecating-static-attributes-in-factory_bot-4-11
        title { 'Agile' }
      end
      after(:build) do |user, evaluator|
        user.book = FactoryBot.create(:book, title: evaluator.title)
      end
    end
  end

  factory :book, class Book do
    sequence(:title) { |n| "book no.#{n}" } # 🦄 default value
  end

end

# usage
let!(:user) { create(:user, :with_book, title: 'Ruby') }
</code></pre>
<p>Source: <a href="https://dev.to/n350071/rspec-factorybot-transient-trait-with-argument-2djd">dev.to/n350071</a></p>
<h2 id="railsworld2023"><a class="header" href="#railsworld2023">RailsWorld2023</a></h2>
<p>Some notes on talks:</p>
<ul>
<li>Turbo morphing
<ul>
<li>new feature for keep scrolling position on whole dom body change</li>
</ul>
</li>
<li>no-build / bun
<ul>
<li>key goal to eliminate build time for frontend stuff, ship as code</li>
</ul>
</li>
<li>if assignment block
<pre><code class="language-ruby">def test
  42
end
if a = test
	puts "Assign #{a}"
else
  puts "Nil is return"
end
</code></pre>
</li>
<li>Class.method(:name).source_location
<ul>
<li>get code location of a method</li>
</ul>
</li>
<li>Model attribute strict_loading prohibit loading relations</li>
<li>Migration add_column :virtual</li>
</ul>
<pre><code class="language-ruby">create_table :users do |t|
  t.numeric :height_cm
  t.virtual :height_in, type: :numeric, as: 'height_cm / 2.54', stored: true
end
</code></pre>
<ul>
<li>Model with_options relations</li>
</ul>
<pre><code class="language-ruby">class User
  with_options dependent: :destroy do |options|
    options.has_many :tasks, class_name: "UserTask"
    options.has_many :addresses
  end
end
</code></pre>
<ul>
<li>try(:method_name) || default_method</li>
<li>Routing constraints
<ul>
<li>subdomain</li>
<li>authenticated</li>
</ul>
</li>
<li>Routes draw split into files</li>
<li>rails generate generator ApiClient</li>
<li>String truncate_words with omission</li>
<li>DateTime before? past? future?</li>
<li>Time.current.all_day .all_week …</li>
<li>Abbreviation number_to_human() round_mode significant format units</li>
</ul>
<h2 id="professional-ruby-on-rails-developer-with-rails-5"><a class="header" href="#professional-ruby-on-rails-developer-with-rails-5">Professional Ruby on Rails Developer with Rails 5</a></h2>
<p>Some notes while doing the <a href="https://www.udemy.com/course/pro-ruby-on-rails-rails5/">udamy course</a> and some <a href="./ruby.html">ruby</a> notes:</p>
<h3 id="basics"><a class="header" href="#basics">Basics</a></h3>
<p>Render plain text:</p>
<pre><code class="language-ruby">def hello
  render plain: "hello world!"
end
</code></pre>
<p>Create a controller with a method and use a object in view:</p>
<pre><code class="language-ruby"># controller
class TodosController &lt; ApplicationController

  def new
   @todo = Todo.new
  end

end

# view
&lt;%= form_for @todo do |f| %&gt;

&lt;% end %&gt;
</code></pre>
<p>Use <code>flash</code> for notifications:</p>
<pre><code class="language-ruby">#controller
@todo.save
flash[:notice] = "Todo was created successfully"

# view
&lt;% flash.each do |name, msg| %&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;% end %&gt;
</code></pre>
<p>A bootstrap styled flash messages:</p>
<pre><code class="language-ruby">&lt;div class="row"&gt;
  &lt;div class="col-md-10 col-md-offset-1"&gt;
    &lt;% flash.each do |name, msg| %&gt;
      &lt;div class="alert alert-&lt;%= name %&gt;"&gt;
        &lt;a href="#" class="close" data-dismiss="alert"&gt;×&lt;/a&gt;
        &lt;%= msg %&gt;
      &lt;/div&gt;
    &lt;% end %&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>Render partials in view ie a file <code>views/layouts/_messages.html.erb</code>:</p>
<pre><code class="language-ruby">&lt;%= render 'layouts/messages' %&gt;
</code></pre>
<p>Before run a method do action:</p>
<pre><code class="language-ruby"># controller
before_action :set_todo, only: [:edit, :update, :show, :destroy]

private

  def set_todo
    @todo = Todo.find(params[:id])
  end

  def todo_params
    params.require(:todo).permit(:name, :description)
  end

  # permit has_many list
  def recipe_params
    params.require(:recipe).permit(:name, :description, ingredient_ids: [])
  end

end
</code></pre>
<p>Add pg to production for ie. heroku deployment:</p>
<pre><code class="language-ruby">group :production do
  gem 'pg'
end

bundle install --without production
</code></pre>
<p>Some simple validations:</p>
<pre><code class="language-ruby">validates :name, presence: true
validates :description, presence: true, length: { minimum: 5, maximum: 500 }
</code></pre>
<p>Application helpers:</p>
<pre><code class="language-ruby">helper_method :current_chef, :logged_in?

def current_chef
  @current_chef ||= Chef.find(session[:chef_id]) if session[:chef_id]
end

def logged_in?
  !!current_chef
end

def require_user
  if !logged_in?
    flash[:danger] = "You must be logged in to perform that action"
    redirect_to root_path
    # also possible
    redirect_to :back
  end
end
</code></pre>
<p>Render partial for model:</p>
<pre><code class="language-ruby"># View
&lt;% if recipe.ingredients.any? %&gt;
  &lt;p&gt;Ingredients: &lt;%= render recipe.ingredients %&gt;&lt;/p&gt;
&lt;% end %&gt;

# Now create a new partial _ingredient.html.erb under the app/views/ingredients folder for this to work

&lt;span class="badge"&gt;&lt;%= link_to ingredient.name, 
                      ingredient_path(ingredient) %&gt;   &lt;/span&gt;
</code></pre>
<h3 id="model"><a class="header" href="#model">Model</a></h3>
<p>Order models by column:</p>
<pre><code class="language-ruby"># order by updated_at -&gt; top of model
default_scope -&gt; { order(updated_at: :desc) }
</code></pre>
<p>Get just the last 20 entries of a model</p>
<pre><code class="language-ruby">def self.most_recent
  order(:created_at).last(20)
end
</code></pre>
<h3 id="routes"><a class="header" href="#routes">Routes</a></h3>
<p>Set root route:</p>
<pre><code class="language-ruby"># router.rb
root "pages#home"
</code></pre>
<p>Specific route to controller#method:</p>
<pre><code class="language-ruby">get '/about', to: 'pages#about'
</code></pre>
<p>Nested routes:</p>
<pre><code class="language-ruby">resources :recipes do
  resources :comments, only: [:create]
end

# Form in view
&lt;%= form\_for(\[@recipe, @comment\], :html =&gt; {class: "form-horizontal", 
                                                role: "form"}) do |f| %&gt;
</code></pre>
<h3 id="links"><a class="header" href="#links">Links</a></h3>
<p>Create links in views:</p>
<pre><code class="language-ruby">&lt;%= link_to "Edit this todo", edit_todo_path(@todo) %&gt;
&lt;%= link_to "Back to todos listing", todos_path %&gt;
&lt;td&gt;&lt;%= link_to 'delete', todo_path(todo), method: :delete, data: { confirm: "Are you sure?"} %&gt;&lt;/td&gt;
&lt;%= link_to "MyRecipes", root_path, class: "navbar-brand", id: "logo" %&gt;
&lt;%= link_to "Sign up or log in", "#" class: "btn btn-danger btn-lg" %&gt;
</code></pre>
<h3 id="tests"><a class="header" href="#tests">Tests</a></h3>
<p>Create integration test for model:</p>
<pre><code class="language-ruby">rails generate integration_test recipes
</code></pre>
<p>Simple test root path:</p>
<pre><code class="language-ruby">test "should get home" do
  get pages_home_url
  assert_response :success
end

test "should get root" do
  get root_url
  assert_response :success
end
</code></pre>
<p>to fix this tests, do:</p>
<pre><code class="language-ruby">root "pages#home"
get 'pages/home', to: 'pages#home'

# controller
class PagesController &lt; ApplicationController
  def home
  end
end
</code></pre>
<p>Test a simple validation:</p>
<pre><code class="language-ruby">require 'test_helper'

class RecipeTest &lt; ActiveSupport::TestCase

  def setup
    @recipe = Recipe.new(name: "vegetable", description: "great vegetable recipe")
  end

  test "recipe should be valid" do
    assert @recipe.valid?
  end

  test "name should be present" do
    @recipe.name = " "
    assert_not @recipe.valid?
  end

  test "description should be present" do
    @recipe.description = " "
    assert_not @recipe.valid?
  end

  test "description shouldn't be less than 5 characters" do
    @recipe.description = "a" * 3
    assert_not @recipe.valid?
  end

  test "description shouldn't be more than 500 characters" do
    @recipe.description = "a" * 501
    assert_not @recipe.valid?
  end

  test "should get recipes show" do
    get recipe_path(@recipe)
    assert_template 'recipes/show'
    assert_match @recipe.name, response.body
    assert_match @recipe.description, response.body
    assert_match @chef.chefname, response.body
  end

  test "should get recipes listing" do
    get recipes_path
    assert_template 'recipes/index'
    assert_select "a[href=?]", recipe_path(@recipe), text: @recipe.name
    assert_select "a[href=?]", recipe_path(@recipe2), text: @recipe2.name
  end
end
</code></pre>
<p>Test a email validation:</p>
<pre><code class="language-ruby">require 'test_helper'

class ChefTest &lt; ActiveSupport::TestCase

  def setup
    @chef = Chef.new(chefname: "mashrur", email: "mashrur@example.com")
  end

  test "should be valid" do
    assert @chef.valid?
  end

  test "name should be present" do
    @chef.chefname = " "
    assert_not @chef.valid?
  end

  test "name should be less than 30 characters" do
    @chef.chefname = "a" * 31
    assert_not @chef.valid?
  end

  test "email should be present" do
    @chef.email = " "
    assert_not @chef.valid?
  end

  test "email should not be too long" do
    @chef.email = "a" * 245 + "@example.com"
    assert_not @chef.valid?
  end

  test "email should accept correct format" do
    valid_emails = %w[user@example.com MASHRUR@gmail.com M.first@yahoo.ca john+smith@co.uk.org]
    valid_emails.each do |valids|
      @chef.email = valids
      assert @chef.valid?, "#{valids.inspect} should be valid"
    end
  end

  test "should reject invalid addresses" do
    invalid_emails = %w[mashrur@example mashrur@example,com mashrur.name@gmail. joe@bar+foo.com]
    invalid_emails.each do |invalids|
      @chef.email = invalids
      assert_not @chef.valid?, "#{invalids.inspect} should be invalid"
    end
  end

  test "email should be unique and case insensitive" do
    duplicate_chef = @chef.dup
    duplicate_chef.email = @chef.email.upcase
    @chef.save
    assert_not duplicate_chef.valid?
  end

  test "reject an invalid signup" do
    get signup_path
    assert_no_difference "Chef.count" do
      post chefs_path, params: { chef: { chefname: " ",
                                 email: " ", password: "password",
                                    password_confirmation: " " } }
    end
    assert_template 'chefs/new'
    assert_select 'h2.panel-title'
    assert_select 'div.panel-body'
  end

  test "accept valid signup" do
    get signup_path
    assert_difference "Chef.count", 1 do
      post chefs_path, params: { chef: { chefname: "mashrur",
                email: "mashrur@example.com", password: "password",
                              password_confirmation: "password" } }
    end
    follow_redirect!
    assert_template 'chefs/show'
    assert_not flash.empty?
  end

end

# controller
class Chef &lt; ApplicationRecord
  validates :chefname, presence: true, length: { maximum: 30 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, length: { maximum: 255 },
                    format: { with: VALID_EMAIL_REGEX },
                    uniqueness: { case_sensitive: false }

end
</code></pre>
<p>Downcase before save with test:</p>
<pre><code class="language-ruby">before_save { self.email = email.downcase }

# And then test it with:

test "email should be lower case before hitting db" do
  mixed_email = "JohN@ExampLe.com"
  @chef.email = mixed_email
  @chef.save
  assert_equal mixed_email.downcase, @chef.reload.email
end
</code></pre>
<p>Create a association and test it:</p>
<p>Association</p>
<pre><code class="language-ruby"># chef model
validates :chef_id, presence: true
has_many :recipes

# recipe model
belongs_to :chef

# destroy with dependent
has_many :recipes, dependent: :destroy
</code></pre>
<p>Test</p>
<pre><code class="language-ruby">def setup
  @chef = Chef.create!(chefname: "mashrur", email: "mashrur@example.com")
  @recipe = @chef.recipes.build(name: "vegetable", description: "great vegetable recipe")
end

test "recipe without chef should be invalid" do
  @recipe.chef_id = nil
  assert_not @recipe.valid?
end
</code></pre>
<h3 id="styling"><a class="header" href="#styling">Styling</a></h3>
<p>Add <code>bootstrap</code> to project (good html/css tutorial <a href="https://learn.shayhowe.com/html-css/">link</a>):</p>
<pre><code class="language-ruby">gem 'bootstrap-sass', '~&gt; 3.3.7'
gem 'jquery-rails'

# app/assets/javascripts/application.js
//= require bootstrap-sprockets

# app/assets/stylesheets/custom.css.scss
@import "bootstrap-sprockets";
@import "bootstrap";
</code></pre>
<h3 id="views"><a class="header" href="#views">Views</a></h3>
<p>Render html for each data:</p>
<pre><code class="language-ruby">&lt;%= f.collection_check_boxes :ingredient_ids, 
                                    Ingredient.all, :id, :name do |cb| %&gt;
&lt;% cb.label(class: "checkbox-inline input_checkbox") {cb.check_box(class: "checkbox") + cb.text} %&gt;
      &lt;% end %&gt;
</code></pre>
<h3 id="database"><a class="header" href="#database">Database</a></h3>
<p>Create migration:</p>
<pre><code class="language-ruby">rails generate migration create_recipes

# modify the migration file
rails db:migrate
</code></pre>
<p>Rename column:</p>
<pre><code class="language-ruby">rename_column :recipes, :email, :description
rails db:migrate
</code></pre>
<p>Many to many association:</p>
<pre><code class="language-ruby"># Model
has_many :recipe_ingredients
has_many :recipes, through: :recipe_ingredients
</code></pre>
<footer id="last-change">Last change: 2024-05-15, commit: <a href="https://github.com/dvogt23/notes/commit/b8ebcff">b8ebcff</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../tech/coding/python.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../tech/coding/react.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../tech/coding/python.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../tech/coding/react.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
